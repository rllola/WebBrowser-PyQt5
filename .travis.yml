os: osx
language: generic
env: PYTHON=3.6
sudo: true

install:
  - pip3 install https://github.com/rllola/pyinstaller/archive/test_pyqt5_from_scratch.zip
  - sudo pip3 install PyQt5 cffi

script:
  - pyinstaller --windowed browser.spec
  - brew install tree
  - tree /usr/local/lib/python3.6/site-packages/PyQt5
  - ./dist/WebBrowser.app/Contents/MacOS/WebBrowser

before_deploy:
  - zip -r build-$TRAVIS_OS_NAME.zip dist/WebBrowser.app

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: $GH_TOKEN
  file:
    - build-$TRAVIS_OS_NAME.zip
  on:
    tags: true
